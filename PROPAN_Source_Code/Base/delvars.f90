!-----------------------------------------------------------------------------------------------!
!    Delete Variables                                                                           !
!    Copyright (C) 2021  J. Baltazar                                                            !
!                                                                                               !
!    This program is free software: you can redistribute it and/or modify it under the terms of !
!    the GNU Affero General Public License as published by the Free Software Foundation, either !
!    version 3 of the License, or (at your option) any later version.                           !
!                                                                                               !
!    This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;  !
!    without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  !
!    See the GNU Affero General Public License for more details.                                !
!                                                                                               !
!    You should have received a copy of the GNU Affero General Public License                   !
!    along with this program.  If not, see <https://www.gnu.org/licenses/>.                     !
!-----------------------------------------------------------------------------------------------!
SUBROUTINE DELVARS
!-----------------------------------------------------------------------------------------------!
!    Created by: 28102013, J. Baltazar, version 1.0                                             !
!    Modified  : 02122013, J. Baltazar, version 1.0                                             !
!    Modified  : 06112014, J. Baltazar, version 3.0, Cavitation Model                           !
!    Modified  : 11112014, J. Baltazar, version 3.1, Unsteady Cavitation Model                  !
!    Modified  : 27112014, J. Baltazar, version 3.3, Super-Cavitation Model                     !
!    Modified  : 29112014, J. Baltazar, version 3.4, Unsteady Super-Cavitation Model            !
!    Modified  : 10022016, J. Baltazar, 2016 version 1.0                                        !
!    Modified  : 27052016, J. Baltazar, 2016 version 1.2                                        !
!    Modified  : 24102016, J. Baltazar, 2016 version 1.4                                        !
!    Modified  : 23062020, J. Baltazar, 2020 version 1.2, Dynamic inflow                        !
!-----------------------------------------------------------------------------------------------!
USE PROPAN_MOD
IMPLICIT NONE
!-----------------------------------------------------------------------------------------------!
!    Calculation Conditions                                                                     !
!-----------------------------------------------------------------------------------------------!
DEALLOCATE(WRR,WTT)
DEALLOCATE(VX,VT,VR)
DEALLOCATE(ANVX,BNVX,ANVT,BNVT,ANVR,BNVR)
!-----------------------------------------------------------------------------------------------!
!    Geometry and Metrics                                                                       !
!-----------------------------------------------------------------------------------------------!
!    Blade                                                                                      !
!-----------------------------------------------------------------------------------------------!
IF (IP == 1) THEN
   DEALLOCATE(XP,YP,ZP,RP,TP)
   DEALLOCATE(XP0,YP0,ZP0,AP0)
   DEALLOCATE(UNXP0,UNYP0,UNZP0)
   DEALLOCATE(ET1XP,ET1YP,ET1ZP,ET2XP,ET2YP,ET2ZP)
   DEALLOCATE(AT1XP,AT1YP,AT1ZP,AT2XP,AT2YP,AT2ZP)
   DEALLOCATE(UNXC0,UNYC0,UNZC0)
END IF !(IP == 1)
!-----------------------------------------------------------------------------------------------!
!    Blade Wake                                                                                 !
!-----------------------------------------------------------------------------------------------!
IF (IP == 1) THEN
   DEALLOCATE(XPW,YPW,ZPW,RPW,TPW)
   DEALLOCATE(XPW0,YPW0,ZPW0,APW0)
   DEALLOCATE(UNXPW0,UNYPW0,UNZPW0)
   DEALLOCATE(AT1XPW,AT1YPW,AT1ZPW)
   DEALLOCATE(AT2XPW,AT2YPW,AT2ZPW)
   IF (NCPW /= 0) DEALLOCATE(ET1XPW,ET1YPW,ET1ZPW)
END IF !(IP == 1)
!-----------------------------------------------------------------------------------------------!
!    Nozzle                                                                                     !
!-----------------------------------------------------------------------------------------------!
IF (IN == 1) THEN
   DEALLOCATE(XN,YN,ZN,RN,TN)
   DEALLOCATE(XN0,YN0,ZN0,AN0)
   DEALLOCATE(UNXN0,UNYN0,UNZN0)
   DEALLOCATE(ET1XN,ET1YN,ET1ZN,ET2XN,ET2YN,ET2ZN)
   DEALLOCATE(AT1XN,AT1YN,AT1ZN,AT2XN,AT2YN,AT2ZN)
END IF !(IN == 1)
!-----------------------------------------------------------------------------------------------!
!    Nozzle Wake                                                                                !
!-----------------------------------------------------------------------------------------------!
IF (IN == 1) THEN
   DEALLOCATE(XNW,YNW,ZNW,RNW,TNW)
   DEALLOCATE(XNW0,YNW0,ZNW0,ANW0)
   DEALLOCATE(UNXNW0,UNYNW0,UNZNW0)
   DEALLOCATE(AT1XNW,AT1YNW,AT1ZNW)
   DEALLOCATE(AT2XNW,AT2YNW,AT2ZNW)
END IF !(IN == 1)
!-----------------------------------------------------------------------------------------------!
!    Hub                                                                                        !
!-----------------------------------------------------------------------------------------------!
IF (IABS(IH) == 1) THEN
   DEALLOCATE(XH,YH,ZH,RH,TH)
   DEALLOCATE(XH0,YH0,ZH0,AH0)
   DEALLOCATE(UNXH0,UNYH0,UNZH0)
   DEALLOCATE(ET1XH,ET1YH,ET1ZH,ET2XH,ET2YH,ET2ZH)
   DEALLOCATE(AT1XH,AT1YH,AT1ZH,AT2XH,AT2YH,AT2ZH)
END IF !(IABS(IH) == 1)
!-----------------------------------------------------------------------------------------------!
!    Numerical Differentiation                                                                  !
!-----------------------------------------------------------------------------------------------!
!    Blade                                                                                      !
!-----------------------------------------------------------------------------------------------!
IF (IP == 1) DEALLOCATE(A1P,B1P,C1P,A2P,B2P,C2P,D2P,E2P,AA2P,BB2P,CC2P)
!-----------------------------------------------------------------------------------------------!
!    Blade Wake                                                                                 !
!-----------------------------------------------------------------------------------------------!
IF ((IP == 1).AND.(NCPW /= 0)) DEALLOCATE(A1PW,B1PW,C1PW)
!-----------------------------------------------------------------------------------------------!
!    Nozzle                                                                                     !
!-----------------------------------------------------------------------------------------------!
IF (IN == 1) DEALLOCATE(A1N,B1N,C1N,A2N,B2N,C2N,D2N,E2N)
!-----------------------------------------------------------------------------------------------!
!    Hub                                                                                        !
!-----------------------------------------------------------------------------------------------!
IF (IABS(IH) == 1) DEALLOCATE(A1H,B1H,C1H,A2H,B2H,C2H,D2H,E2H)
!-----------------------------------------------------------------------------------------------!
!    Influence Coefficients Matrix                                                              !
!-----------------------------------------------------------------------------------------------!
DEALLOCATE(DIJ,SIJ,WIJ)
IF (NT > 0) DEALLOCATE(KIJ)
!-----------------------------------------------------------------------------------------------!
!    Potential                                                                                  !
!-----------------------------------------------------------------------------------------------!
!    Blade                                                                                      !
!-----------------------------------------------------------------------------------------------!
IF (IP == 1) DEALLOCATE(POTP,SOURCEP)
!-----------------------------------------------------------------------------------------------!
!    Blade Wake                                                                                 !
!-----------------------------------------------------------------------------------------------!
IF (IP == 1) DEALLOCATE(DPOTP)
!-----------------------------------------------------------------------------------------------!
!    Nozzle                                                                                     !
!-----------------------------------------------------------------------------------------------!
IF (IN == 1) DEALLOCATE(POTN,SOURCEN)
!-----------------------------------------------------------------------------------------------!
!    Nozzle Wake                                                                                !
!-----------------------------------------------------------------------------------------------!
IF (IN == 1) DEALLOCATE(DPOTN)
!-----------------------------------------------------------------------------------------------!
!    Hub                                                                                        !
!-----------------------------------------------------------------------------------------------!
IF (IABS(IH) == 1) DEALLOCATE(POTH,SOURCEH)
!-----------------------------------------------------------------------------------------------!
!    Velocities and Pressure                                                                    !
!-----------------------------------------------------------------------------------------------!
!    Blade                                                                                      !
!-----------------------------------------------------------------------------------------------!
IF (IP == 1) THEN
   DEALLOCATE(VT1P,VT2P,VT2S,VTT1P,VTT2P)
   DEALLOCATE(CPP,CPNP)
END IF !(IP == 1)
!-----------------------------------------------------------------------------------------------!
!    Blade Gap                                                                                  !
!-----------------------------------------------------------------------------------------------!
IF (ISTRIP == 1) DEALLOCATE(DCPG)
!-----------------------------------------------------------------------------------------------!
!    Blade Wake                                                                                 !
!-----------------------------------------------------------------------------------------------!
IF (IP == 1) DEALLOCATE(DCP)
IF ((IP == 1).AND.(NCPW /= 0)) DEALLOCATE(VT1PW)
!-----------------------------------------------------------------------------------------------!
!    Nozzle                                                                                     !
!-----------------------------------------------------------------------------------------------!
IF (IN == 1) THEN
   DEALLOCATE(VT1N,VT2N,VTT1N,VTT2N)
   DEALLOCATE(CPN,CPNN)
END IF !(IN == 1)
!-----------------------------------------------------------------------------------------------!
!    Nozzle Wake                                                                                !
!-----------------------------------------------------------------------------------------------!
IF (IN == 1) DEALLOCATE(DCN)
!-----------------------------------------------------------------------------------------------!
!    Hub                                                                                        !
!-----------------------------------------------------------------------------------------------!
IF (IABS(IH) == 1) THEN
   DEALLOCATE(VT1H,VT2H,VTT1H,VTT2H)
   DEALLOCATE(CPH,CPNH)
END IF !(IABS(IH) == 1)
!-----------------------------------------------------------------------------------------------!
!    Cavitation                                                                                 !
!-----------------------------------------------------------------------------------------------!
!    Blade                                                                                      !
!-----------------------------------------------------------------------------------------------!
IF (IP == 1) THEN
   DEALLOCATE(IDP,IRP,IDS,IRS)
   IF (NCAV > 0) DEALLOCATE(THICKP,SOURCEPCAV)
   IF ((NCAV > 0).AND.(IRED == 1)) DEALLOCATE(POTPWET)
END IF !(IP == 1)
!-----------------------------------------------------------------------------------------------!
!    Blade Wake                                                                                 !
!-----------------------------------------------------------------------------------------------!
IF (IP == 1) THEN
   DEALLOCATE(IDPWP,IRPWP,IDPWS,IRPWS)
   IF ((NCAV > 0).AND.(IRED == 1)) DEALLOCATE(POTPWWET)
   IF ((NCAV > 0).AND.(NCPW  < 0)) THEN
      DEALLOCATE(THICKPWP,CAMBERPWP,POTPWP,SOURCEPWCAV)
      IF (IRED == 1) DEALLOCATE(POTPWPWET)
   END IF !((NCAV > 0).AND.(NCPW  < 0))
   IF ((NCAV > 0).AND.(NCPW  > 0)) THEN
      DEALLOCATE(THICKPWS,CAMBERPWS,POTPWS,SOURCEPWCAV)
      IF (IRED == 1) DEALLOCATE(POTPWSWET)
   END IF !((NCAV > 0).AND.(NCPW  > 0))
END IF !(IP == 1)
!-----------------------------------------------------------------------------------------------!
!    Nozzle                                                                                     !
!-----------------------------------------------------------------------------------------------!
IF (IN == 1) THEN
   IF ((NCAV > 0).AND.(IRED == 1)) DEALLOCATE(POTNWET)
END IF !(IN == 1)
!-----------------------------------------------------------------------------------------------!
!    Nozzle Wake                                                                                !
!-----------------------------------------------------------------------------------------------!
IF (IN == 1) THEN
   IF ((NCAV > 0).AND.(IRED == 1)) DEALLOCATE(POTNWWET)
END IF !(IN == 1)
!-----------------------------------------------------------------------------------------------!
!    Hub                                                                                        !
!-----------------------------------------------------------------------------------------------!
IF (IABS(IH) == 1) THEN
   IF ((NCAV > 0).AND.(IRED == 1)) DEALLOCATE(POTHWET)
END IF !(IABS(IH) == 1)
!-----------------------------------------------------------------------------------------------!
!    Force Coefficients                                                                         !
!-----------------------------------------------------------------------------------------------!
!    Blade                                                                                      !
!-----------------------------------------------------------------------------------------------!
IF (IP == 1) DEALLOCATE(CFXP,CMXP,CFYP,CMYP,CFZP,CMZP,CTXP,CQXP,CTYP,CQYP,CTZP,CQZP)
!-----------------------------------------------------------------------------------------------!
!    Nozzle                                                                                     !
!-----------------------------------------------------------------------------------------------!
IF (IN == 1) DEALLOCATE(CFXN,CMXN,CFYN,CMYN,CFZN,CMZN,CTXN,CQXN,CTYN,CQYN,CTZN,CQZN)
!-----------------------------------------------------------------------------------------------!
!    Hub                                                                                        !
!-----------------------------------------------------------------------------------------------!
IF (IN == 1) DEALLOCATE(CFXH,CMXH,CFYH,CMYH,CFZH,CMZH,CTXH,CQXH,CTYH,CQYH,CTZH,CQZH)
!-----------------------------------------------------------------------------------------------!
!    Right Hand Side                                                                            !
!-----------------------------------------------------------------------------------------------!
DEALLOCATE(SI,RHS)
!-----------------------------------------------------------------------------------------------!
!    LU Decomposition Vectors                                                                   !
!-----------------------------------------------------------------------------------------------!
DEALLOCATE(IPVT1,IPVT2,IPVT3,IPVT4)
IF (NCAV > 0) DEALLOCATE(IPVTC1,IPVTC2,IPVTC4)
!-----------------------------------------------------------------------------------------------!
!    Velocity Field                                                                             !
!-----------------------------------------------------------------------------------------------!
IF (IFIELD == 1) DEALLOCATE(XVF,YVF,ZVF,VFX,VFY,VFZ)
!-----------------------------------------------------------------------------------------------!
!    Pressure Field                                                                             !
!-----------------------------------------------------------------------------------------------!
IF (IFIELD == 1) DEALLOCATE(POTF,DPOTFDT)
!-----------------------------------------------------------------------------------------------!
END SUBROUTINE DELVARS
!-----------------------------------------------------------------------------------------------!
