!-----------------------------------------------------------------------------------------------!
SUBROUTINE STRET(S,S0,NP)
!-----------------------------------------------------------------------------------------------!
IMPLICIT NONE
INTEGER :: NP,NP1,I,NIT
DOUBLE PRECISION :: S(NP),S0,RNP1,SXX,DX,COEF,XI,ARG,SHXX
!-----------------------------------------------------------------------------------------------!
S(1)=0.D0
S(NP)=1.D0
NP1=NP-1
RNP1=DFLOAT(NP1)
!-----------------------------------------------------------------------------------------------!
IF (S0 < 0.999D0) THEN
!-----------------------------------------------------------------------------------------------!
   DX=SXX(S0)/2.D0
   COEF=1.D0/TAN(DX)
   DO I=2,NP1
      XI=(DFLOAT(I)-1.D0)/RNP1
      ARG=DX*(XI-1.D0)
      S(I)=1.D0+DTAN(ARG)*COEF
   END DO !I=2,NP1
!-----------------------------------------------------------------------------------------------!
ELSEIF (S0 > 1.001D0) THEN
!-----------------------------------------------------------------------------------------------!
   DX=SHXX(S0)/2.D0
   COEF=1.D0/DTANH(DX)
   DO I=2,NP1
      XI=(DFLOAT(I)-1.D0)/RNP1
      ARG=DX*(XI-1.D0)
      S(I)=1.D0+DTANH(ARG)*COEF
   END DO !I=2,NP1
!-----------------------------------------------------------------------------------------------!
ELSE
!-----------------------------------------------------------------------------------------------!
   DO I=2,NP1
      NIT=0
      XI=(DFLOAT(I)-1.D0)/RNP1
      S(I)=XI*(1.D0-0.5D0*(S0-1.D0)*(1.D0-XI)*(2.D0-XI))
   END DO !I=2,NP1
!-----------------------------------------------------------------------------------------------!
END IF
!-----------------------------------------------------------------------------------------------!
END SUBROUTINE STRET
!-----------------------------------------------------------------------------------------------!
