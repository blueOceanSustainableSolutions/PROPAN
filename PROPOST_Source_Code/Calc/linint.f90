!-----------------------------------------------------------------------------------------------!
!    Linear Inter or Extrapolation                                                              !
!    INPUT     NDATA = number of X values and number of function values                         !
!                      NDATA must be greater than 2                                             !
!              X     = array of X-values                                                        !
!              Z     = array of function values                                                 !
!              N     = number of XX values and number of interpolated values                    !
!              XX    = X-value to be interpolated                                               !
!    OUTPUT    ZZ    = interpolated function value                                              !
!                                                                                               !
!    REMARK..the X-values need not be equidistant but must be monotonically increasing          !
!-----------------------------------------------------------------------------------------------!
SUBROUTINE LININT(NDATA,X,Z,N,XX,ZZ)
!-----------------------------------------------------------------------------------------------!
!    Revised by: Joao Baltazar, IST, January 2006                                               !
!-----------------------------------------------------------------------------------------------!
IMPLICIT NONE
INTEGER          :: I,J,JJ,NDATA,N
DOUBLE PRECISION :: X(NDATA),Z(NDATA),XX(N),ZZ(N),FF
!-----------------------------------------------------------------------------------------------!
DO JJ=1,N
!-----------------------------------------------------------------------------------------------!
   FF=0.D0
   DO J=1,NDATA
      FF=XX(JJ)-X(J)
      IF (FF == 0.D0) THEN
         ZZ(JJ)=Z(J)
         GOTO 10
      END IF !(FF == 0.D0)
      IF (FF < 0.D0) THEN
         IF (J == 1) THEN
!-----------------------------------------------------------------------------------------------!
!    Extrapolation                                                                              !
!-----------------------------------------------------------------------------------------------!
            ZZ(JJ)=Z(1)-(Z(2)-Z(1))*(X(1)-XX(JJ))/(X(2)-X(1))
         ELSE !(J == 1)
!-----------------------------------------------------------------------------------------------!
!    Interpolation                                                                              !
!-----------------------------------------------------------------------------------------------!
            ZZ(JJ)=Z(J-1)+(Z(J)-Z(J-1))*(XX(JJ)-X(J-1))/(X(J)-X(J-1))
         END IF !(J == 1)
         GOTO 10
      END IF !(FF < 0.D0)
   END DO !J=1,NDATA
!-----------------------------------------------------------------------------------------------!
!    Extrapolation                                                                              !
!-----------------------------------------------------------------------------------------------!
   ZZ(JJ)=Z(NDATA)+(Z(NDATA)-Z(NDATA-1))*(XX(JJ)-X(NDATA))/(X(NDATA)-X(NDATA-1))
10 CONTINUE
!-----------------------------------------------------------------------------------------------!
END DO !J=1,N
!-----------------------------------------------------------------------------------------------!
END SUBROUTINE LININT
!-----------------------------------------------------------------------------------------------!
