!-----------------------------------------------------------------------------------------------!
!    The subroutine determines the interval where a value lies in an monotonic array values     !
!-----------------------------------------------------------------------------------------------!
SUBROUTINE INTERVAL(N,X,XX,II,CSI)
!-----------------------------------------------------------------------------------------------!
INTEGER :: N,II
DOUBLE PRECISION :: XX,CSI,X(100),D1,D2,D
!-----------------------------------------------------------------------------------------------!
DO I=1,N-1
   D1=XX-X(I)
   D2=XX-X(I+1)
   D=D1*D2
   IF (D <= 0.D0) II=I
END DO !I=1,N-1
!-----------------------------------------------------------------------------------------------!
IF (XX < X(1)) II=1
IF (XX > X(N)) II=N-1
CSI=(XX-X(II))/(X(II+1)-X(II))
!-----------------------------------------------------------------------------------------------!
END SUBROUTINE INTERVAL
!-----------------------------------------------------------------------------------------------!
